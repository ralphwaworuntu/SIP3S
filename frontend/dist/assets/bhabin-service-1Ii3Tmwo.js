import{g as n,v as h}from"./index-Cb9iWb3X.js";import{e as w,f as p,g as b,h as k,i as g}from"./mock-data-Bmemdn2s.js";const r={recipients:"sip3s.bhabin.recipients",plant:"sip3s.bhabin.plant",harvest:"sip3s.bhabin.harvest",escort:"sip3s.bhabin.escort"},a=(c,t)=>{if(typeof window>"u")return t;try{const e=window.localStorage.getItem(c);return e?JSON.parse(e)??t:(window.localStorage.setItem(c,JSON.stringify(t)),t)}catch(e){return console.warn("Gagal membaca cache Bhabin",e),t}},u=(c,t)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(c,JSON.stringify(t))}catch(e){console.warn("Gagal menyimpan cache Bhabin",e)}};class d{async listAssignments(t){if(!t)return[];try{const{data:e}=await n.get("/bhabin/assignments",{params:{email:t}});return e}catch{return w.filter(i=>i.bhabinEmail===t).map(i=>({id:i.id,bhabinEmail:i.bhabinEmail,wilayahId:i.wilayahId,wilayahName:i.wilayahName,kecamatan:i.kecamatan,desa:i.desa,pplEmail:i.pplEmail}))}}async listRecipients(){try{const{data:t}=await n.get("/bhabin/recipients");return t}catch{return a(r.recipients,p)}}async verifyRecipient(t){try{const{data:e}=await n.post("/bhabin/recipients/verify",t);return e}catch{const s=a(r.recipients,p).map(o=>o.id===t.id?{...o,status:"verified",verifiedAt:new Date().toISOString(),notes:t.notes,lokasi:t.lokasi,fotoEvidence:t.fotoEvidence,productType:t.productType,seedType:t.seedType,seedQuantityKg:t.seedQuantityKg,pupukNpkKg:t.pupukNpkKg,pupukUreaKg:t.pupukUreaKg}:o);return u(r.recipients,s),s.find(o=>o.id===t.id)??{...p[0],status:"verified",verifiedAt:new Date().toISOString(),notes:t.notes,lokasi:t.lokasi,fotoEvidence:t.fotoEvidence,productType:t.productType,seedType:t.seedType,seedQuantityKg:t.seedQuantityKg,pupukNpkKg:t.pupukNpkKg,pupukUreaKg:t.pupukUreaKg}}}async listPlantProgress(){try{const{data:t}=await n.get("/bhabin/plant-progress");return t}catch{return a(r.plant,b)}}async submitPlantProgress(t){try{const{data:e}=await n.post("/bhabin/plant-progress",t);return e}catch{const i={id:h(),wilayah:t.wilayah,petani:t.petani,komoditas:t.komoditas,fase:t.fase,kondisi:t.kondisi,catatan:t.catatan,updatedAt:new Date().toISOString(),lokasi:t.lokasi,fotoEvidence:t.fotoEvidence,pupukDigunakanKg:t.pupukDigunakanKg,luasLahanBersihM2:t.luasLahanBersihM2,bibitDitanamKg:t.bibitDitanamKg},s=[i,...a(r.plant,b)];return u(r.plant,s),i}}async listHarvestVerifications(){try{const{data:t}=await n.get("/bhabin/harvests");return t}catch{return a(r.harvest,k)}}async submitHarvestVerification(t){try{const{data:e}=await n.post("/bhabin/harvests",t);return e}catch{const i={id:h(),petani:t.petani,komoditas:t.komoditas,luasPanenHa:t.luasPanenHa,produksiTon:t.produksiTon,lokasi:t.lokasi,diverifikasiAt:new Date().toISOString(),keterangan:t.keterangan,koordinat:t.koordinat,fotoEvidence:t.fotoEvidence},s=[i,...a(r.harvest,k)];return u(r.harvest,s),i}}async listEscortRequests(){try{const{data:t}=await n.get("/bhabin/escorts");return t}catch{return a(r.escort,g)}}async submitEscortRequest(t){try{const{data:e}=await n.post("/bhabin/escorts",t);return e}catch{const i={id:h(),wilayah:t.wilayah,jadwal:t.jadwal,titikKumpul:t.titikKumpul,estimasiPeserta:t.estimasiPeserta,kebutuhanPersonel:t.kebutuhanPersonel,status:"baru",catatan:t.catatan,diajukanOleh:t.diajukanOleh,diajukanAt:new Date().toISOString()},s=[i,...a(r.escort,g)];return u(r.escort,s),i}}}const v=new d;export{v as b};
//# sourceMappingURL=bhabin-service-1Ii3Tmwo.js.map
