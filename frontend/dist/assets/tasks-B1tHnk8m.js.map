{"version":3,"file":"tasks-B1tHnk8m.js","sources":["../../src/pages/dashboard/bhabinkamtibmas/tasks.tsx"],"sourcesContent":["import { useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { CalendarBlank, MapPinLine, UsersThree } from \"@phosphor-icons/react\";\n\nimport { Alert } from \"@/components/ui/alert\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useAuth } from \"@/context/auth-context\";\nimport { useOnlineStatus } from \"@/context/online-status-context\";\nimport { taskService } from \"@/services/task-service\";\nimport type { Task } from \"@/types/task\";\n\nconst statusCopy: Record<Task[\"status\"], { label: string; variant: \"success\" | \"warning\" | \"neutral\" }> = {\n  baru: { label: \"Baru\", variant: \"warning\" },\n  proses: { label: \"Proses\", variant: \"neutral\" },\n  selesai: { label: \"Selesai\", variant: \"success\" },\n};\n\nconst priorityLabel: Record<Task[\"priority\"], string> = {\n  low: \"Prioritas rendah\",\n  medium: \"Prioritas sedang\",\n  high: \"Prioritas tinggi\",\n};\n\nconst formatDate = (value: string) =>\n  new Date(value).toLocaleDateString(\"id-ID\", { weekday: \"long\", day: \"numeric\", month: \"long\" });\n\nconst BhabinTasksPage = () => {\n  const { user } = useAuth();\n  const { isOnline } = useOnlineStatus();\n\n  const { data: tasks = [], isLoading } = useQuery({\n    queryKey: [\"tasks\", \"bhabin\"],\n    queryFn: () => taskService.list(),\n  });\n\n  const assignedTasks = useMemo(() => {\n    if (!user?.email) return tasks;\n    return tasks.filter((task) => task.assignedTo.includes(user.email));\n  }, [tasks, user?.email]);\n\n  const jointTasks = useMemo(() => assignedTasks.filter((task) => task.assignedTo.length > 1), [assignedTasks]);\n  const personalTasks = useMemo(() => assignedTasks.filter((task) => task.assignedTo.length === 1), [assignedTasks]);\n\n  return (\n    <section className=\"space-y-4\">\n      {!isOnline && (\n        <Alert variant=\"warning\">Data tugas diambil dari cache. Periksa kembali saat koneksi sudah normal.</Alert>\n      )}\n\n      <Card className=\"bg-white\">\n        <CardHeader>\n          <CardTitle>Tugas prioritas Bhabinkamtibmas</CardTitle>\n          <CardDescription>Koordinasikan dengan PPL dan petugas lapangan sesuai wilayah penugasan.</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-3 text-sm text-slate-netral\">\n          {isLoading ? (\n            <p>Memuat daftar tugas...</p>\n          ) : assignedTasks.length === 0 ? (\n            <p>Belum ada tugas yang ditetapkan untuk Anda.</p>\n          ) : (\n            assignedTasks.map((task) => (\n              <div key={task.id} className=\"rounded-2xl border border-abu-kartu p-4\">\n                <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                  <div>\n                    <p className=\"text-base font-semibold text-teks-gelap\">{task.title}</p>\n                    <p className=\"text-xs text-slate-netral\">{priorityLabel[task.priority]}</p>\n                  </div>\n                  <Badge variant={statusCopy[task.status].variant}>{statusCopy[task.status].label}</Badge>\n                </div>\n                <p className=\"mt-2 text-sm\">{task.description}</p>\n                <div className=\"mt-3 flex flex-wrap gap-4 text-xs text-slate-netral\">\n                  <span className=\"inline-flex items-center gap-1\"><MapPinLine weight=\"bold\" className=\"h-4 w-4\" /> {task.region}</span>\n                  <span className=\"inline-flex items-center gap-1\"><CalendarBlank weight=\"bold\" className=\"h-4 w-4\" /> {formatDate(task.dueDate)}</span>\n                  {task.assignedTo.length > 1 && (\n                    <span className=\"inline-flex items-center gap-1 text-biru-pemerintah\">\n                      <UsersThree weight=\"bold\" className=\"h-4 w-4\" /> Kerja tim lintas instansi\n                    </span>\n                  )}\n                </div>\n              </div>\n            ))\n          )}\n        </CardContent>\n      </Card>\n\n      <div className=\"grid gap-4 lg:grid-cols-2\">\n        <Card className=\"bg-white\">\n          <CardHeader>\n            <CardTitle>Tugas kolaboratif</CardTitle>\n            <CardDescription>Libatkan PPL atau petugas lapangan untuk percepatan tindakan.</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm text-slate-netral\">\n            {jointTasks.length === 0 ? (\n              <p>Tidak ada tugas gabungan yang aktif.</p>\n            ) : (\n              jointTasks.map((task) => (\n                <div key={task.id} className=\"rounded-2xl border border-abu-kartu/70 p-3\">\n                  <p className=\"font-medium text-teks-gelap\">{task.title}</p>\n                  <p className=\"text-xs\">Update terakhir: {new Date(task.updatedAt).toLocaleString(\"id-ID\")}</p>\n                </div>\n              ))\n            )}\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-white/95\">\n          <CardHeader>\n            <CardTitle>Tugas mandiri</CardTitle>\n            <CardDescription>Fokus pada pengecekan lapangan harian.</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm text-slate-netral\">\n            {personalTasks.length === 0 ? (\n              <p>Semua tugas saat ini bersifat kolaboratif.</p>\n            ) : (\n              personalTasks.map((task) => (\n                <div key={task.id} className=\"rounded-2xl border border-abu-kartu p-3\">\n                  <p className=\"font-medium text-teks-gelap\">{task.title}</p>\n                  <p className=\"text-xs\">Target selesai: {formatDate(task.dueDate)}</p>\n                </div>\n              ))\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </section>\n  );\n};\n\nexport default BhabinTasksPage;\r\n"],"names":["statusCopy","priorityLabel","formatDate","value","BhabinTasksPage","user","useAuth","isOnline","useOnlineStatus","tasks","isLoading","useQuery","taskService","assignedTasks","useMemo","task","jointTasks","personalTasks","jsxs","jsx","Alert","Card","CardHeader","CardTitle","CardDescription","CardContent","Badge","MapPinLine","CalendarBlank","UsersThree"],"mappings":"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"}