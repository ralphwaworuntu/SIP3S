{"version":3,"file":"index-CRaB7xMb.js","sources":["../../src/pages/dashboard/bhabinkamtibmas/index.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { NavLink, Outlet } from \"react-router-dom\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { SignOut } from \"@phosphor-icons/react\";\r\n\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useAuth } from \"@/context/auth-context\";\r\nimport { useOnlineStatus } from \"@/context/online-status-context\";\r\nimport { bhabinService } from \"@/services/bhabin-service\";\r\nimport type { BhabinAssignment } from \"@/types/bhabin\";\r\n\r\ntype NavItem = { label: string; to: string; end?: boolean };\r\n\r\nconst navItems: NavItem[] = [\r\n  { label: \"Tugas Lapangan\", to: \".\", end: true },\r\n  { label: \"Verifikasi Penyaluran\", to: \"verifikasi\" },\r\n  { label: \"Perkembangan Tanaman\", to: \"tanaman\" },\r\n  { label: \"Verifikasi Hasil Panen\", to: \"panen\" },\r\n  { label: \"Permintaan Pengawalan\", to: \"pengawalan\" },\r\n];\r\n\r\nconst BhabinLayout = () => {\r\n  const { user, logout } = useAuth();\r\n  const { isOnline } = useOnlineStatus();\r\n  const [selectedAssignmentId, setSelectedAssignmentId] = useState<string | null>(null);\r\n\r\n  const assignmentsQuery = useQuery({\r\n    queryKey: [\"bhabin-assignments\", user?.email],\r\n    queryFn: () => bhabinService.listAssignments(user?.email),\r\n    enabled: Boolean(user?.email),\r\n    staleTime: 5 * 60 * 1000,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!selectedAssignmentId && assignmentsQuery.data && assignmentsQuery.data.length > 0) {\r\n      setSelectedAssignmentId(assignmentsQuery.data[0].id);\r\n    }\r\n  }, [assignmentsQuery.data, selectedAssignmentId]);\r\n\r\n  const selectedAssignment: BhabinAssignment | undefined = useMemo(() => {\r\n    return assignmentsQuery.data?.find((assignment) => assignment.id === selectedAssignmentId) ?? undefined;\r\n  }, [assignmentsQuery.data, selectedAssignmentId]);\r\n\r\n  return (\r\n    <main className=\"mx-auto flex min-h-screen max-w-7xl flex-col gap-6 px-4 py-8\">\r\n      <header className=\"rounded-3xl border border-abu-kartu bg-white p-6 shadow-sm\">\r\n        <div className=\"flex flex-wrap items-center justify-between gap-4\">\r\n          <div>\r\n            <p className=\"text-sm text-slate-netral\">Bhabinkamtibmas</p>\r\n            <h1 className=\"text-2xl font-semibold text-teks-gelap\">{user?.nama ?? \"Bhabin\"}</h1>\r\n            <p className=\"text-xs text-slate-netral\">\r\n              Mulai dari membaca tugas, verifikasi penyaluran, sampai pengawalan panen di wilayah binaan.\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center gap-3\">\r\n            <Badge variant={isOnline ? \"success\" : \"warning\"}>{isOnline ? \"Online\" : \"Offline\"}</Badge>\r\n            <Button variant=\"outline\" onClick={logout}>\r\n              <SignOut className=\"mr-2 h-4 w-4\" weight=\"bold\" /> Keluar\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4 flex flex-col gap-2 text-sm text-slate-netral\">\r\n          <label className=\"flex flex-col gap-1\">\r\n            Wilayah kerja aktif\r\n            <select\r\n              value={selectedAssignmentId ?? \"\"}\r\n              onChange={(event) => setSelectedAssignmentId(event.target.value)}\r\n              className=\"w-full rounded-2xl border border-abu-kartu px-3 py-2 text-sm\"\r\n              disabled={assignmentsQuery.data?.length === 0}\r\n            >\r\n              {assignmentsQuery.data?.map((assignment) => (\r\n                <option key={assignment.id} value={assignment.id}>\r\n                  {assignment.wilayahName} â€¢ Kecamatan {assignment.kecamatan}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </label>\r\n          {assignmentsQuery.isLoading && <span className=\"text-xs text-slate-netral\">Memuat wilayah tugas...</span>}\r\n          {assignmentsQuery.data?.length === 0 && !assignmentsQuery.isLoading && (\r\n            <span className=\"text-xs text-oranye-hangat\">\r\n              Belum ada wilayah terdaftar. Hubungi Admin Spesialis untuk mendapatkan assignment.\r\n            </span>\r\n          )}\r\n          {selectedAssignment && (\r\n            <p className=\"text-xs text-slate-netral\">\r\n              Aktif di {selectedAssignment.wilayahName}, Desa {selectedAssignment.desa}, Kecamatan {selectedAssignment.kecamatan}.\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <nav className=\"mt-6 flex flex-wrap gap-2 text-sm\">\r\n          {navItems.map((item) => (\r\n            <NavLink\r\n              key={item.label}\r\n              to={item.to}\r\n              end={item.end}\r\n              className={({ isActive }) =>\r\n                isActive\r\n                  ? \"rounded-2xl border border-biru-pemerintah bg-biru-pemerintah/10 px-4 py-2 font-medium text-biru-pemerintah\"\r\n                  : \"rounded-2xl border border-transparent px-4 py-2 text-slate-netral transition hover:border-biru-pemerintah/40 hover:text-biru-pemerintah\"\r\n              }\r\n            >\r\n              {item.label}\r\n            </NavLink>\r\n          ))}\r\n        </nav>\r\n      </header>\r\n\r\n      <Outlet context={{ selectedAssignment }} />\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default BhabinLayout;\r\n"],"names":["navItems","BhabinLayout","user","logout","useAuth","isOnline","useOnlineStatus","selectedAssignmentId","setSelectedAssignmentId","useState","assignmentsQuery","useQuery","bhabinService","useEffect","selectedAssignment","useMemo","_a","assignment","jsxs","jsx","Badge","Button","SignOut","event","_b","_c","item","NavLink","isActive","Outlet"],"mappings":"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"}