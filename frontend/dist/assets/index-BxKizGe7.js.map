{"version":3,"file":"index-BxKizGe7.js","sources":["../../src/pages/offline/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { ArrowLeft, CloudArrowUp } from \"@phosphor-icons/react\";\nimport { Link } from \"react-router-dom\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Alert } from \"@/components/ui/alert\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ROUTES } from \"@/utils/constants\";\nimport { offlineCache } from \"@/utils/offline-cache\";\n\ninterface PendingItem {\n  id: string;\n  createdAt: number;\n  payload: {\n    komoditas?: string;\n    lokasi?: { alamat?: string };\n    catatan?: string;\n  };\n}\n\nconst OfflinePage = () => {\n  const [pending, setPending] = useState<PendingItem[]>([]);\n\n  useEffect(() => {\n    offlineCache\n      .listPendingReports()\n      .then((items) => setPending(items as PendingItem[]))\n      .catch((error) => console.error(error));\n  }, []);\n\n  const handleSync = async () => {\n    if (navigator.serviceWorker?.controller) {\n      navigator.serviceWorker.controller.postMessage(\"force-sync\");\n    }\n  };\n\n  return (\n    <main className=\"mx-auto flex min-h-[80vh] max-w-5xl flex-col gap-8 px-4 py-10\">\n      <Link to={ROUTES.beranda} className=\"flex items-center gap-2 text-sm text-biru-pemerintah\">\n        <ArrowLeft className=\"h-4 w-4\" weight=\"bold\" /> Kembali ke beranda\n      </Link>\n      <Card className=\"bg-white\">\n        <CardHeader>\n          <CardTitle>Anda sedang offline</CardTitle>\n          <CardDescription>\n            Semua perubahan akan disimpan sementara. Sambungkan perangkat ke internet untuk sinkronisasi otomatis\n            atau tekan tombol sinkronisasi manual di bawah.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Alert variant=\"warning\" className=\"text-sm\">\n            Pastikan koneksi stabil sebelum mengunggah ulang foto dan data besar.\n          </Alert>\n          <Button onClick={handleSync} className=\"w-full\">\n            <CloudArrowUp className=\"mr-2 h-5 w-5\" weight=\"bold\" /> Paksa Sinkronisasi\n          </Button>\n        </CardContent>\n      </Card>\n      <section className=\"space-y-4\">\n        <h2 className=\"text-lg font-semibold text-teks-gelap\">Laporan menunggu sinkronisasi</h2>\n        <div className=\"space-y-3\">\n          {pending.length === 0 && <p className=\"text-sm text-slate-netral\">Tidak ada data menunggu.</p>}\n          {pending.map((item) => (\n            <div key={item.id} className=\"rounded-2xl border border-abu-kartu bg-abu-kartu/50 p-4 text-sm text-slate-netral\">\n              <p className=\"font-medium text-teks-gelap\">{item.payload?.komoditas ?? \"Laporan Lapangan\"}</p>\n              <p>{item.payload?.lokasi?.alamat ?? \"Lokasi belum tersedia\"}</p>\n              <p className=\"text-xs\">Catatan: {item.payload?.catatan ?? \"-\"}</p>\n              <p className=\"text-xs text-slate-netral/80\">Disimpan: {new Date(item.createdAt).toLocaleString(\"id-ID\")}</p>\n            </div>\n          ))}\n        </div>\n      </section>\n    </main>\n  );\n};\n\nexport default OfflinePage;\r\n"],"names":["OfflinePage","pending","setPending","useState","useEffect","offlineCache","items","error","handleSync","_a","jsxs","Link","ROUTES","jsx","ArrowLeft","Card","CardHeader","CardTitle","CardDescription","CardContent","Alert","Button","CloudArrowUp","item","_c","_b","_d"],"mappings":"kRAoBA,MAAMA,EAAc,IAAM,CACxB,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAwB,CAAA,CAAE,EAExDC,EAAAA,UAAU,IAAM,CACdC,EACG,mBAAA,EACA,KAAMC,GAAUJ,EAAWI,CAAsB,CAAC,EAClD,MAAOC,GAAU,QAAQ,MAAMA,CAAK,CAAC,CAC1C,EAAG,CAAA,CAAE,EAEL,MAAMC,EAAa,SAAY,QACzBC,EAAA,UAAU,gBAAV,MAAAA,EAAyB,YAC3B,UAAU,cAAc,WAAW,YAAY,YAAY,CAE/D,EAEA,OACEC,EAAAA,KAAC,OAAA,CAAK,UAAU,gEACd,SAAA,CAAAA,OAACC,EAAA,CAAK,GAAIC,EAAO,QAAS,UAAU,uDAClC,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAU,UAAU,UAAU,OAAO,OAAO,EAAE,qBAAA,EACjD,EACAJ,EAAAA,KAACK,EAAA,CAAK,UAAU,WACd,SAAA,CAAAL,OAACM,EAAA,CACC,SAAA,CAAAH,EAAAA,IAACI,GAAU,SAAA,qBAAA,CAAmB,EAC9BJ,EAAAA,IAACK,GAAgB,SAAA,uJAAA,CAGjB,CAAA,EACF,EACAR,EAAAA,KAACS,EAAA,CAAY,UAAU,YACrB,SAAA,CAAAN,MAACO,EAAA,CAAM,QAAQ,UAAU,UAAU,UAAU,SAAA,wEAE7C,EACAV,EAAAA,KAACW,EAAA,CAAO,QAASb,EAAY,UAAU,SACrC,SAAA,CAAAK,EAAAA,IAACS,EAAA,CAAa,UAAU,eAAe,OAAO,OAAO,EAAE,qBAAA,CAAA,CACzD,CAAA,CAAA,CACF,CAAA,EACF,EACAZ,EAAAA,KAAC,UAAA,CAAQ,UAAU,YACjB,SAAA,CAAAG,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,gCAA6B,EACnFH,EAAAA,KAAC,MAAA,CAAI,UAAU,YACZ,SAAA,CAAAT,EAAQ,SAAW,GAAKY,MAAC,IAAA,CAAE,UAAU,4BAA4B,SAAA,2BAAwB,EACzFZ,EAAQ,IAAKsB,gBACZb,OAAAA,EAAAA,KAAC,MAAA,CAAkB,UAAU,oFAC3B,SAAA,CAAAG,MAAC,KAAE,UAAU,8BAA+B,WAAAJ,EAAAc,EAAK,UAAL,YAAAd,EAAc,YAAa,mBAAmB,QACzF,IAAA,CAAG,WAAAe,GAAAC,EAAAF,EAAK,UAAL,YAAAE,EAAc,SAAd,YAAAD,EAAsB,SAAU,wBAAwB,EAC5Dd,EAAAA,KAAC,IAAA,CAAE,UAAU,UAAU,SAAA,CAAA,cAAUgB,EAAAH,EAAK,UAAL,YAAAG,EAAc,UAAW,GAAA,EAAI,EAC9DhB,EAAAA,KAAC,IAAA,CAAE,UAAU,+BAA+B,SAAA,CAAA,aAAW,IAAI,KAAKa,EAAK,SAAS,EAAE,eAAe,OAAO,CAAA,CAAA,CAAE,CAAA,CAAA,EAJhGA,EAAK,EAKf,EACD,CAAA,CAAA,CACH,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}